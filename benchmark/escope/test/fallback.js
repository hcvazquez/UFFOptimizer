'use strict';

var _chai = require('chai');

var _esprima = require('esprima');

var _esprima2 = _interopRequireDefault(_esprima);

var _ = require('..');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

describe('fallback option', function () {
    it('should raise an error when it encountered an unknown node if no fallback.', function () {
        var ast = _esprima2.default.parse('\n            var foo = 0;\n        ');

        ast.body[0].declarations[0].init.type = 'NumericLiteral';

        (0, _chai.expect)(function () {
            (0, _.analyze)(ast, { fallback: 'none' });
        }).to.throw("Unknown node type NumericLiteral");
    });

    it('should not raise an error even if it encountered an unknown node when fallback is iteration.', function () {
        var ast = _esprima2.default.parse('\n            var foo = 0;\n        ');

        ast.body[0].declarations[0].init.type = 'NumericLiteral';

        (0, _.analyze)(ast); // default is `fallback: 'iteration'`
        (0, _.analyze)(ast, { fallback: 'iteration' });
    });

    it('should not raise an error even if it encountered an unknown node when fallback is a function.', function () {
        var ast = _esprima2.default.parse('\n            var foo = 0;\n        ');

        ast.body[0].declarations[0].init.type = 'NumericLiteral';

        (0, _.analyze)(ast, { fallback: function fallback(node) {
                return Object.keys(node);
            } });
    });
});

// vim: set sw=4 ts=4 et tw=80 :
// -*- coding: utf-8 -*-
//  Copyright (C) 2016 Yusuke Suzuki <utatane.tea@gmail.com>
//
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//    * Redistributions of source code must retain the above copyright
//      notice, this list of conditions and the following disclaimer.
//    * Redistributions in binary form must reproduce the above copyright
//      notice, this list of conditions and the following disclaimer in the
//      documentation and/or other materials provided with the distribution.
//
//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
//  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
//  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
//  ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
//  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
//  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
//  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
//  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
//  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
//  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZhbGxiYWNrLmpzIl0sIm5hbWVzIjpbImRlc2NyaWJlIiwiaXQiLCJhc3QiLCJwYXJzZSIsImJvZHkiLCJkZWNsYXJhdGlvbnMiLCJpbml0IiwidHlwZSIsImZhbGxiYWNrIiwidG8iLCJ0aHJvdyIsIk9iamVjdCIsImtleXMiLCJub2RlIl0sIm1hcHBpbmdzIjoiOztBQXVCQTs7QUFDQTs7OztBQUNBOzs7O0FBRUFBLFNBQVMsaUJBQVQsRUFBNEIsWUFBVztBQUNuQ0MsT0FBRywyRUFBSCxFQUFnRixZQUFXO0FBQ3ZGLFlBQU1DLE1BQU0sa0JBQVFDLEtBQVIsd0NBQVo7O0FBSUFELFlBQUlFLElBQUosQ0FBUyxDQUFULEVBQVlDLFlBQVosQ0FBeUIsQ0FBekIsRUFBNEJDLElBQTVCLENBQWlDQyxJQUFqQyxHQUF3QyxnQkFBeEM7O0FBRUEsMEJBQU8sWUFBVztBQUNkLDJCQUFRTCxHQUFSLEVBQWEsRUFBQ00sVUFBVSxNQUFYLEVBQWI7QUFDSCxTQUZELEVBRUdDLEVBRkgsQ0FFTUMsS0FGTixDQUVZLGtDQUZaO0FBR0gsS0FWRDs7QUFZQVQsT0FBRyw4RkFBSCxFQUFtRyxZQUFXO0FBQzFHLFlBQU1DLE1BQU0sa0JBQVFDLEtBQVIsd0NBQVo7O0FBSUFELFlBQUlFLElBQUosQ0FBUyxDQUFULEVBQVlDLFlBQVosQ0FBeUIsQ0FBekIsRUFBNEJDLElBQTVCLENBQWlDQyxJQUFqQyxHQUF3QyxnQkFBeEM7O0FBRUEsdUJBQVFMLEdBQVIsRUFQMEcsQ0FPNUY7QUFDZCx1QkFBUUEsR0FBUixFQUFhLEVBQUNNLFVBQVUsV0FBWCxFQUFiO0FBQ0gsS0FURDs7QUFXQVAsT0FBRywrRkFBSCxFQUFvRyxZQUFXO0FBQzNHLFlBQU1DLE1BQU0sa0JBQVFDLEtBQVIsd0NBQVo7O0FBSUFELFlBQUlFLElBQUosQ0FBUyxDQUFULEVBQVlDLFlBQVosQ0FBeUIsQ0FBekIsRUFBNEJDLElBQTVCLENBQWlDQyxJQUFqQyxHQUF3QyxnQkFBeEM7O0FBRUEsdUJBQVFMLEdBQVIsRUFBYSxFQUFDTSxVQUFVO0FBQUEsdUJBQVFHLE9BQU9DLElBQVAsQ0FBWUMsSUFBWixDQUFSO0FBQUEsYUFBWCxFQUFiO0FBQ0gsS0FSRDtBQVNILENBakNEOztBQW1DQTtBQTlEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJmYWxsYmFjay5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIC0qLSBjb2Rpbmc6IHV0Zi04IC0qLVxuLy8gIENvcHlyaWdodCAoQykgMjAxNiBZdXN1a2UgU3V6dWtpIDx1dGF0YW5lLnRlYUBnbWFpbC5jb20+XG4vL1xuLy8gIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dFxuLy8gIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuLy9cbi8vICAgICogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHRcbi8vICAgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLlxuLy8gICAgKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodFxuLy8gICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlXG4vLyAgICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uXG4vL1xuLy8gIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMgXCJBUyBJU1wiXG4vLyAgQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRVxuLy8gIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFXG4vLyAgQVJFIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIDxDT1BZUklHSFQgSE9MREVSPiBCRSBMSUFCTEUgRk9SIEFOWVxuLy8gIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTXG4vLyAgKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTO1xuLy8gIExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORFxuLy8gIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUXG4vLyAgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GXG4vLyAgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cblxuaW1wb3J0IHsgZXhwZWN0IH0gZnJvbSAnY2hhaSc7XG5pbXBvcnQgZXNwcmltYSBmcm9tICdlc3ByaW1hJztcbmltcG9ydCB7IGFuYWx5emUgfSBmcm9tICcuLic7XG5cbmRlc2NyaWJlKCdmYWxsYmFjayBvcHRpb24nLCBmdW5jdGlvbigpIHtcbiAgICBpdCgnc2hvdWxkIHJhaXNlIGFuIGVycm9yIHdoZW4gaXQgZW5jb3VudGVyZWQgYW4gdW5rbm93biBub2RlIGlmIG5vIGZhbGxiYWNrLicsIGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zdCBhc3QgPSBlc3ByaW1hLnBhcnNlKGBcbiAgICAgICAgICAgIHZhciBmb28gPSAwO1xuICAgICAgICBgKTtcblxuICAgICAgICBhc3QuYm9keVswXS5kZWNsYXJhdGlvbnNbMF0uaW5pdC50eXBlID0gJ051bWVyaWNMaXRlcmFsJztcblxuICAgICAgICBleHBlY3QoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBhbmFseXplKGFzdCwge2ZhbGxiYWNrOiAnbm9uZSd9KTtcbiAgICAgICAgfSkudG8udGhyb3coXCJVbmtub3duIG5vZGUgdHlwZSBOdW1lcmljTGl0ZXJhbFwiKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IHJhaXNlIGFuIGVycm9yIGV2ZW4gaWYgaXQgZW5jb3VudGVyZWQgYW4gdW5rbm93biBub2RlIHdoZW4gZmFsbGJhY2sgaXMgaXRlcmF0aW9uLicsIGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zdCBhc3QgPSBlc3ByaW1hLnBhcnNlKGBcbiAgICAgICAgICAgIHZhciBmb28gPSAwO1xuICAgICAgICBgKTtcblxuICAgICAgICBhc3QuYm9keVswXS5kZWNsYXJhdGlvbnNbMF0uaW5pdC50eXBlID0gJ051bWVyaWNMaXRlcmFsJztcblxuICAgICAgICBhbmFseXplKGFzdCk7IC8vIGRlZmF1bHQgaXMgYGZhbGxiYWNrOiAnaXRlcmF0aW9uJ2BcbiAgICAgICAgYW5hbHl6ZShhc3QsIHtmYWxsYmFjazogJ2l0ZXJhdGlvbid9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IHJhaXNlIGFuIGVycm9yIGV2ZW4gaWYgaXQgZW5jb3VudGVyZWQgYW4gdW5rbm93biBub2RlIHdoZW4gZmFsbGJhY2sgaXMgYSBmdW5jdGlvbi4nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc3QgYXN0ID0gZXNwcmltYS5wYXJzZShgXG4gICAgICAgICAgICB2YXIgZm9vID0gMDtcbiAgICAgICAgYCk7XG5cbiAgICAgICAgYXN0LmJvZHlbMF0uZGVjbGFyYXRpb25zWzBdLmluaXQudHlwZSA9ICdOdW1lcmljTGl0ZXJhbCc7XG5cbiAgICAgICAgYW5hbHl6ZShhc3QsIHtmYWxsYmFjazogbm9kZSA9PiBPYmplY3Qua2V5cyhub2RlKX0pO1xuICAgIH0pO1xufSk7XG5cbi8vIHZpbTogc2V0IHN3PTQgdHM9NCBldCB0dz04MCA6XG4iXX0=
