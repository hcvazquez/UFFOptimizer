'use strict';

var _chai = require('chai');

var _esprima = require('../third_party/esprima');

var _ = require('..');

describe('ES6 class', function () {
    it('declaration name creates class scope', function () {
        var ast = (0, _esprima.parse)('\n            class Derived extends Base {\n                constructor() {\n                }\n            }\n            new Derived();\n        ');

        var scopeManager = (0, _.analyze)(ast, { ecmaVersion: 6 });
        (0, _chai.expect)(scopeManager.scopes).to.have.length(3);

        var scope = scopeManager.scopes[0];
        (0, _chai.expect)(scope.type).to.be.equal('global');
        (0, _chai.expect)(scope.block.type).to.be.equal('Program');
        (0, _chai.expect)(scope.isStrict).to.be.false;
        (0, _chai.expect)(scope.variables).to.have.length(1);
        (0, _chai.expect)(scope.variables[0].name).to.be.equal('Derived');
        (0, _chai.expect)(scope.references).to.have.length(2);
        (0, _chai.expect)(scope.references[0].identifier.name).to.be.equal('Base');
        (0, _chai.expect)(scope.references[1].identifier.name).to.be.equal('Derived');

        scope = scopeManager.scopes[1];
        (0, _chai.expect)(scope.type).to.be.equal('class');
        (0, _chai.expect)(scope.block.type).to.be.equal('ClassDeclaration');
        (0, _chai.expect)(scope.isStrict).to.be.true;
        (0, _chai.expect)(scope.variables).to.have.length(1);
        (0, _chai.expect)(scope.variables[0].name).to.be.equal('Derived');
        (0, _chai.expect)(scope.references).to.have.length(0);

        scope = scopeManager.scopes[2];
        (0, _chai.expect)(scope.type).to.be.equal('function');
        (0, _chai.expect)(scope.block.type).to.be.equal('FunctionExpression');
        (0, _chai.expect)(scope.isStrict).to.be.true;
        (0, _chai.expect)(scope.variables).to.have.length(1);
        (0, _chai.expect)(scope.variables[0].name).to.be.equal('arguments');
        (0, _chai.expect)(scope.references).to.have.length(0);
    });

    it('expression name creates class scope#1', function () {
        var ast = (0, _esprima.parse)('\n            (class Derived extends Base {\n                constructor() {\n                }\n            });\n        ');

        var scopeManager = (0, _.analyze)(ast, { ecmaVersion: 6 });
        (0, _chai.expect)(scopeManager.scopes).to.have.length(3);

        var scope = scopeManager.scopes[0];
        (0, _chai.expect)(scope.type).to.be.equal('global');
        (0, _chai.expect)(scope.block.type).to.be.equal('Program');
        (0, _chai.expect)(scope.isStrict).to.be.false;
        (0, _chai.expect)(scope.variables).to.have.length(0);
        (0, _chai.expect)(scope.references).to.have.length(1);
        (0, _chai.expect)(scope.references[0].identifier.name).to.be.equal('Base');

        scope = scopeManager.scopes[1];
        (0, _chai.expect)(scope.type).to.be.equal('class');
        (0, _chai.expect)(scope.block.type).to.be.equal('ClassExpression');
        (0, _chai.expect)(scope.isStrict).to.be.true;
        (0, _chai.expect)(scope.variables).to.have.length(1);
        (0, _chai.expect)(scope.variables[0].name).to.be.equal('Derived');
        (0, _chai.expect)(scope.references).to.have.length(0);

        scope = scopeManager.scopes[2];
        (0, _chai.expect)(scope.type).to.be.equal('function');
        (0, _chai.expect)(scope.block.type).to.be.equal('FunctionExpression');
    });

    it('expression name creates class scope#2', function () {
        var ast = (0, _esprima.parse)('\n            (class extends Base {\n                constructor() {\n                }\n            });\n        ');

        var scopeManager = (0, _.analyze)(ast, { ecmaVersion: 6 });
        (0, _chai.expect)(scopeManager.scopes).to.have.length(3);

        var scope = scopeManager.scopes[0];
        (0, _chai.expect)(scope.type).to.be.equal('global');
        (0, _chai.expect)(scope.block.type).to.be.equal('Program');
        (0, _chai.expect)(scope.isStrict).to.be.false;
        (0, _chai.expect)(scope.variables).to.have.length(0);
        (0, _chai.expect)(scope.references).to.have.length(1);
        (0, _chai.expect)(scope.references[0].identifier.name).to.be.equal('Base');

        scope = scopeManager.scopes[1];
        (0, _chai.expect)(scope.type).to.be.equal('class');
        (0, _chai.expect)(scope.block.type).to.be.equal('ClassExpression');

        scope = scopeManager.scopes[2];
        (0, _chai.expect)(scope.type).to.be.equal('function');
        (0, _chai.expect)(scope.block.type).to.be.equal('FunctionExpression');
    });

    it('computed property key may refer variables', function () {
        var ast = (0, _esprima.parse)('\n            (function () {\n                var yuyushiki = 42;\n                (class {\n                    [yuyushiki]() {\n                    }\n\n                    [yuyushiki + 40]() {\n                    }\n                });\n            }());\n        ');

        var scopeManager = (0, _.analyze)(ast, { ecmaVersion: 6 });
        (0, _chai.expect)(scopeManager.scopes).to.have.length(5);

        var scope = scopeManager.scopes[0];
        (0, _chai.expect)(scope.type).to.be.equal('global');
        (0, _chai.expect)(scope.block.type).to.be.equal('Program');
        (0, _chai.expect)(scope.isStrict).to.be.false;

        scope = scopeManager.scopes[1];
        (0, _chai.expect)(scope.type).to.be.equal('function');
        (0, _chai.expect)(scope.block.type).to.be.equal('FunctionExpression');
        (0, _chai.expect)(scope.isStrict).to.be.false;
        (0, _chai.expect)(scope.variables).to.have.length(2);
        (0, _chai.expect)(scope.variables[0].name).to.be.equal('arguments');
        (0, _chai.expect)(scope.variables[1].name).to.be.equal('yuyushiki');
        (0, _chai.expect)(scope.references).to.have.length(1);
        (0, _chai.expect)(scope.references[0].identifier.name).to.be.equal('yuyushiki');

        scope = scopeManager.scopes[2];
        (0, _chai.expect)(scope.type).to.be.equal('class');
        (0, _chai.expect)(scope.block.type).to.be.equal('ClassExpression');
        (0, _chai.expect)(scope.isStrict).to.be.true;
        (0, _chai.expect)(scope.variables).to.have.length(0);
        (0, _chai.expect)(scope.references).to.have.length(2);
        (0, _chai.expect)(scope.references[0].identifier.name).to.be.equal('yuyushiki');
        (0, _chai.expect)(scope.references[1].identifier.name).to.be.equal('yuyushiki');
    });

    it('regression #49', function () {
        var ast = (0, _esprima.parse)('\n            class Shoe {\n                constructor() {\n                    //Shoe.x = true;\n                }\n            }\n            let shoe = new Shoe();\n        ');

        var scopeManager = (0, _.analyze)(ast, { ecmaVersion: 6 });
        (0, _chai.expect)(scopeManager.scopes).to.have.length(3);

        var scope = scopeManager.scopes[0];
        (0, _chai.expect)(scope.type).to.be.equal('global');
        (0, _chai.expect)(scope.block.type).to.be.equal('Program');
        (0, _chai.expect)(scope.isStrict).to.be.false;
        (0, _chai.expect)(scope.variables).to.have.length(2);
        (0, _chai.expect)(scope.variables[0].name).to.be.equal('Shoe');
        (0, _chai.expect)(scope.variables[1].name).to.be.equal('shoe');
        (0, _chai.expect)(scope.references).to.have.length(2);
        (0, _chai.expect)(scope.references[0].identifier.name).to.be.equal('shoe');
        (0, _chai.expect)(scope.references[1].identifier.name).to.be.equal('Shoe');
    });
});

// vim: set sw=4 ts=4 et tw=80 :
// -*- coding: utf-8 -*-
//  Copyright (C) 2014 Yusuke Suzuki <utatane.tea@gmail.com>
//
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//    * Redistributions of source code must retain the above copyright
//      notice, this list of conditions and the following disclaimer.
//    * Redistributions in binary form must reproduce the above copyright
//      notice, this list of conditions and the following disclaimer in the
//      documentation and/or other materials provided with the distribution.
//
//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
//  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
//  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
//  ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
//  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
//  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
//  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
//  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
//  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
//  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVzNi1jbGFzcy5qcyJdLCJuYW1lcyI6WyJkZXNjcmliZSIsIml0IiwiYXN0Iiwic2NvcGVNYW5hZ2VyIiwiZWNtYVZlcnNpb24iLCJzY29wZXMiLCJ0byIsImhhdmUiLCJsZW5ndGgiLCJzY29wZSIsInR5cGUiLCJiZSIsImVxdWFsIiwiYmxvY2siLCJpc1N0cmljdCIsImZhbHNlIiwidmFyaWFibGVzIiwibmFtZSIsInJlZmVyZW5jZXMiLCJpZGVudGlmaWVyIiwidHJ1ZSJdLCJtYXBwaW5ncyI6Ijs7QUF1QkE7O0FBQ0E7O0FBQ0E7O0FBRUFBLFNBQVMsV0FBVCxFQUFzQixZQUFXO0FBQzdCQyxPQUFHLHNDQUFILEVBQTJDLFlBQVc7QUFDbEQsWUFBTUMsTUFBTSwwS0FBWjs7QUFRQSxZQUFNQyxlQUFlLGVBQVFELEdBQVIsRUFBYSxFQUFDRSxhQUFhLENBQWQsRUFBYixDQUFyQjtBQUNBLDBCQUFPRCxhQUFhRSxNQUFwQixFQUE0QkMsRUFBNUIsQ0FBK0JDLElBQS9CLENBQW9DQyxNQUFwQyxDQUEyQyxDQUEzQzs7QUFFQSxZQUFJQyxRQUFRTixhQUFhRSxNQUFiLENBQW9CLENBQXBCLENBQVo7QUFDQSwwQkFBT0ksTUFBTUMsSUFBYixFQUFtQkosRUFBbkIsQ0FBc0JLLEVBQXRCLENBQXlCQyxLQUF6QixDQUErQixRQUEvQjtBQUNBLDBCQUFPSCxNQUFNSSxLQUFOLENBQVlILElBQW5CLEVBQXlCSixFQUF6QixDQUE0QkssRUFBNUIsQ0FBK0JDLEtBQS9CLENBQXFDLFNBQXJDO0FBQ0EsMEJBQU9ILE1BQU1LLFFBQWIsRUFBdUJSLEVBQXZCLENBQTBCSyxFQUExQixDQUE2QkksS0FBN0I7QUFDQSwwQkFBT04sTUFBTU8sU0FBYixFQUF3QlYsRUFBeEIsQ0FBMkJDLElBQTNCLENBQWdDQyxNQUFoQyxDQUF1QyxDQUF2QztBQUNBLDBCQUFPQyxNQUFNTyxTQUFOLENBQWdCLENBQWhCLEVBQW1CQyxJQUExQixFQUFnQ1gsRUFBaEMsQ0FBbUNLLEVBQW5DLENBQXNDQyxLQUF0QyxDQUE0QyxTQUE1QztBQUNBLDBCQUFPSCxNQUFNUyxVQUFiLEVBQXlCWixFQUF6QixDQUE0QkMsSUFBNUIsQ0FBaUNDLE1BQWpDLENBQXdDLENBQXhDO0FBQ0EsMEJBQU9DLE1BQU1TLFVBQU4sQ0FBaUIsQ0FBakIsRUFBb0JDLFVBQXBCLENBQStCRixJQUF0QyxFQUE0Q1gsRUFBNUMsQ0FBK0NLLEVBQS9DLENBQWtEQyxLQUFsRCxDQUF3RCxNQUF4RDtBQUNBLDBCQUFPSCxNQUFNUyxVQUFOLENBQWlCLENBQWpCLEVBQW9CQyxVQUFwQixDQUErQkYsSUFBdEMsRUFBNENYLEVBQTVDLENBQStDSyxFQUEvQyxDQUFrREMsS0FBbEQsQ0FBd0QsU0FBeEQ7O0FBRUFILGdCQUFRTixhQUFhRSxNQUFiLENBQW9CLENBQXBCLENBQVI7QUFDQSwwQkFBT0ksTUFBTUMsSUFBYixFQUFtQkosRUFBbkIsQ0FBc0JLLEVBQXRCLENBQXlCQyxLQUF6QixDQUErQixPQUEvQjtBQUNBLDBCQUFPSCxNQUFNSSxLQUFOLENBQVlILElBQW5CLEVBQXlCSixFQUF6QixDQUE0QkssRUFBNUIsQ0FBK0JDLEtBQS9CLENBQXFDLGtCQUFyQztBQUNBLDBCQUFPSCxNQUFNSyxRQUFiLEVBQXVCUixFQUF2QixDQUEwQkssRUFBMUIsQ0FBNkJTLElBQTdCO0FBQ0EsMEJBQU9YLE1BQU1PLFNBQWIsRUFBd0JWLEVBQXhCLENBQTJCQyxJQUEzQixDQUFnQ0MsTUFBaEMsQ0FBdUMsQ0FBdkM7QUFDQSwwQkFBT0MsTUFBTU8sU0FBTixDQUFnQixDQUFoQixFQUFtQkMsSUFBMUIsRUFBZ0NYLEVBQWhDLENBQW1DSyxFQUFuQyxDQUFzQ0MsS0FBdEMsQ0FBNEMsU0FBNUM7QUFDQSwwQkFBT0gsTUFBTVMsVUFBYixFQUF5QlosRUFBekIsQ0FBNEJDLElBQTVCLENBQWlDQyxNQUFqQyxDQUF3QyxDQUF4Qzs7QUFFQUMsZ0JBQVFOLGFBQWFFLE1BQWIsQ0FBb0IsQ0FBcEIsQ0FBUjtBQUNBLDBCQUFPSSxNQUFNQyxJQUFiLEVBQW1CSixFQUFuQixDQUFzQkssRUFBdEIsQ0FBeUJDLEtBQXpCLENBQStCLFVBQS9CO0FBQ0EsMEJBQU9ILE1BQU1JLEtBQU4sQ0FBWUgsSUFBbkIsRUFBeUJKLEVBQXpCLENBQTRCSyxFQUE1QixDQUErQkMsS0FBL0IsQ0FBcUMsb0JBQXJDO0FBQ0EsMEJBQU9ILE1BQU1LLFFBQWIsRUFBdUJSLEVBQXZCLENBQTBCSyxFQUExQixDQUE2QlMsSUFBN0I7QUFDQSwwQkFBT1gsTUFBTU8sU0FBYixFQUF3QlYsRUFBeEIsQ0FBMkJDLElBQTNCLENBQWdDQyxNQUFoQyxDQUF1QyxDQUF2QztBQUNBLDBCQUFPQyxNQUFNTyxTQUFOLENBQWdCLENBQWhCLEVBQW1CQyxJQUExQixFQUFnQ1gsRUFBaEMsQ0FBbUNLLEVBQW5DLENBQXNDQyxLQUF0QyxDQUE0QyxXQUE1QztBQUNBLDBCQUFPSCxNQUFNUyxVQUFiLEVBQXlCWixFQUF6QixDQUE0QkMsSUFBNUIsQ0FBaUNDLE1BQWpDLENBQXdDLENBQXhDO0FBQ0gsS0FyQ0Q7O0FBdUNBUCxPQUFHLHVDQUFILEVBQTRDLFlBQVc7QUFDbkQsWUFBTUMsTUFBTSxpSkFBWjs7QUFPQSxZQUFNQyxlQUFlLGVBQVFELEdBQVIsRUFBYSxFQUFDRSxhQUFhLENBQWQsRUFBYixDQUFyQjtBQUNBLDBCQUFPRCxhQUFhRSxNQUFwQixFQUE0QkMsRUFBNUIsQ0FBK0JDLElBQS9CLENBQW9DQyxNQUFwQyxDQUEyQyxDQUEzQzs7QUFFQSxZQUFJQyxRQUFRTixhQUFhRSxNQUFiLENBQW9CLENBQXBCLENBQVo7QUFDQSwwQkFBT0ksTUFBTUMsSUFBYixFQUFtQkosRUFBbkIsQ0FBc0JLLEVBQXRCLENBQXlCQyxLQUF6QixDQUErQixRQUEvQjtBQUNBLDBCQUFPSCxNQUFNSSxLQUFOLENBQVlILElBQW5CLEVBQXlCSixFQUF6QixDQUE0QkssRUFBNUIsQ0FBK0JDLEtBQS9CLENBQXFDLFNBQXJDO0FBQ0EsMEJBQU9ILE1BQU1LLFFBQWIsRUFBdUJSLEVBQXZCLENBQTBCSyxFQUExQixDQUE2QkksS0FBN0I7QUFDQSwwQkFBT04sTUFBTU8sU0FBYixFQUF3QlYsRUFBeEIsQ0FBMkJDLElBQTNCLENBQWdDQyxNQUFoQyxDQUF1QyxDQUF2QztBQUNBLDBCQUFPQyxNQUFNUyxVQUFiLEVBQXlCWixFQUF6QixDQUE0QkMsSUFBNUIsQ0FBaUNDLE1BQWpDLENBQXdDLENBQXhDO0FBQ0EsMEJBQU9DLE1BQU1TLFVBQU4sQ0FBaUIsQ0FBakIsRUFBb0JDLFVBQXBCLENBQStCRixJQUF0QyxFQUE0Q1gsRUFBNUMsQ0FBK0NLLEVBQS9DLENBQWtEQyxLQUFsRCxDQUF3RCxNQUF4RDs7QUFFQUgsZ0JBQVFOLGFBQWFFLE1BQWIsQ0FBb0IsQ0FBcEIsQ0FBUjtBQUNBLDBCQUFPSSxNQUFNQyxJQUFiLEVBQW1CSixFQUFuQixDQUFzQkssRUFBdEIsQ0FBeUJDLEtBQXpCLENBQStCLE9BQS9CO0FBQ0EsMEJBQU9ILE1BQU1JLEtBQU4sQ0FBWUgsSUFBbkIsRUFBeUJKLEVBQXpCLENBQTRCSyxFQUE1QixDQUErQkMsS0FBL0IsQ0FBcUMsaUJBQXJDO0FBQ0EsMEJBQU9ILE1BQU1LLFFBQWIsRUFBdUJSLEVBQXZCLENBQTBCSyxFQUExQixDQUE2QlMsSUFBN0I7QUFDQSwwQkFBT1gsTUFBTU8sU0FBYixFQUF3QlYsRUFBeEIsQ0FBMkJDLElBQTNCLENBQWdDQyxNQUFoQyxDQUF1QyxDQUF2QztBQUNBLDBCQUFPQyxNQUFNTyxTQUFOLENBQWdCLENBQWhCLEVBQW1CQyxJQUExQixFQUFnQ1gsRUFBaEMsQ0FBbUNLLEVBQW5DLENBQXNDQyxLQUF0QyxDQUE0QyxTQUE1QztBQUNBLDBCQUFPSCxNQUFNUyxVQUFiLEVBQXlCWixFQUF6QixDQUE0QkMsSUFBNUIsQ0FBaUNDLE1BQWpDLENBQXdDLENBQXhDOztBQUVBQyxnQkFBUU4sYUFBYUUsTUFBYixDQUFvQixDQUFwQixDQUFSO0FBQ0EsMEJBQU9JLE1BQU1DLElBQWIsRUFBbUJKLEVBQW5CLENBQXNCSyxFQUF0QixDQUF5QkMsS0FBekIsQ0FBK0IsVUFBL0I7QUFDQSwwQkFBT0gsTUFBTUksS0FBTixDQUFZSCxJQUFuQixFQUF5QkosRUFBekIsQ0FBNEJLLEVBQTVCLENBQStCQyxLQUEvQixDQUFxQyxvQkFBckM7QUFDSCxLQTlCRDs7QUFnQ0FYLE9BQUcsdUNBQUgsRUFBNEMsWUFBVztBQUNuRCxZQUFNQyxNQUFNLHlJQUFaOztBQU9BLFlBQU1DLGVBQWUsZUFBUUQsR0FBUixFQUFhLEVBQUNFLGFBQWEsQ0FBZCxFQUFiLENBQXJCO0FBQ0EsMEJBQU9ELGFBQWFFLE1BQXBCLEVBQTRCQyxFQUE1QixDQUErQkMsSUFBL0IsQ0FBb0NDLE1BQXBDLENBQTJDLENBQTNDOztBQUVBLFlBQUlDLFFBQVFOLGFBQWFFLE1BQWIsQ0FBb0IsQ0FBcEIsQ0FBWjtBQUNBLDBCQUFPSSxNQUFNQyxJQUFiLEVBQW1CSixFQUFuQixDQUFzQkssRUFBdEIsQ0FBeUJDLEtBQXpCLENBQStCLFFBQS9CO0FBQ0EsMEJBQU9ILE1BQU1JLEtBQU4sQ0FBWUgsSUFBbkIsRUFBeUJKLEVBQXpCLENBQTRCSyxFQUE1QixDQUErQkMsS0FBL0IsQ0FBcUMsU0FBckM7QUFDQSwwQkFBT0gsTUFBTUssUUFBYixFQUF1QlIsRUFBdkIsQ0FBMEJLLEVBQTFCLENBQTZCSSxLQUE3QjtBQUNBLDBCQUFPTixNQUFNTyxTQUFiLEVBQXdCVixFQUF4QixDQUEyQkMsSUFBM0IsQ0FBZ0NDLE1BQWhDLENBQXVDLENBQXZDO0FBQ0EsMEJBQU9DLE1BQU1TLFVBQWIsRUFBeUJaLEVBQXpCLENBQTRCQyxJQUE1QixDQUFpQ0MsTUFBakMsQ0FBd0MsQ0FBeEM7QUFDQSwwQkFBT0MsTUFBTVMsVUFBTixDQUFpQixDQUFqQixFQUFvQkMsVUFBcEIsQ0FBK0JGLElBQXRDLEVBQTRDWCxFQUE1QyxDQUErQ0ssRUFBL0MsQ0FBa0RDLEtBQWxELENBQXdELE1BQXhEOztBQUVBSCxnQkFBUU4sYUFBYUUsTUFBYixDQUFvQixDQUFwQixDQUFSO0FBQ0EsMEJBQU9JLE1BQU1DLElBQWIsRUFBbUJKLEVBQW5CLENBQXNCSyxFQUF0QixDQUF5QkMsS0FBekIsQ0FBK0IsT0FBL0I7QUFDQSwwQkFBT0gsTUFBTUksS0FBTixDQUFZSCxJQUFuQixFQUF5QkosRUFBekIsQ0FBNEJLLEVBQTVCLENBQStCQyxLQUEvQixDQUFxQyxpQkFBckM7O0FBRUFILGdCQUFRTixhQUFhRSxNQUFiLENBQW9CLENBQXBCLENBQVI7QUFDQSwwQkFBT0ksTUFBTUMsSUFBYixFQUFtQkosRUFBbkIsQ0FBc0JLLEVBQXRCLENBQXlCQyxLQUF6QixDQUErQixVQUEvQjtBQUNBLDBCQUFPSCxNQUFNSSxLQUFOLENBQVlILElBQW5CLEVBQXlCSixFQUF6QixDQUE0QkssRUFBNUIsQ0FBK0JDLEtBQS9CLENBQXFDLG9CQUFyQztBQUNILEtBMUJEOztBQTRCQVgsT0FBRywyQ0FBSCxFQUFnRCxZQUFXO0FBQ3ZELFlBQU1DLE1BQU0sbVNBQVo7O0FBYUEsWUFBTUMsZUFBZSxlQUFRRCxHQUFSLEVBQWEsRUFBQ0UsYUFBYSxDQUFkLEVBQWIsQ0FBckI7QUFDQSwwQkFBT0QsYUFBYUUsTUFBcEIsRUFBNEJDLEVBQTVCLENBQStCQyxJQUEvQixDQUFvQ0MsTUFBcEMsQ0FBMkMsQ0FBM0M7O0FBRUEsWUFBSUMsUUFBUU4sYUFBYUUsTUFBYixDQUFvQixDQUFwQixDQUFaO0FBQ0EsMEJBQU9JLE1BQU1DLElBQWIsRUFBbUJKLEVBQW5CLENBQXNCSyxFQUF0QixDQUF5QkMsS0FBekIsQ0FBK0IsUUFBL0I7QUFDQSwwQkFBT0gsTUFBTUksS0FBTixDQUFZSCxJQUFuQixFQUF5QkosRUFBekIsQ0FBNEJLLEVBQTVCLENBQStCQyxLQUEvQixDQUFxQyxTQUFyQztBQUNBLDBCQUFPSCxNQUFNSyxRQUFiLEVBQXVCUixFQUF2QixDQUEwQkssRUFBMUIsQ0FBNkJJLEtBQTdCOztBQUVBTixnQkFBUU4sYUFBYUUsTUFBYixDQUFvQixDQUFwQixDQUFSO0FBQ0EsMEJBQU9JLE1BQU1DLElBQWIsRUFBbUJKLEVBQW5CLENBQXNCSyxFQUF0QixDQUF5QkMsS0FBekIsQ0FBK0IsVUFBL0I7QUFDQSwwQkFBT0gsTUFBTUksS0FBTixDQUFZSCxJQUFuQixFQUF5QkosRUFBekIsQ0FBNEJLLEVBQTVCLENBQStCQyxLQUEvQixDQUFxQyxvQkFBckM7QUFDQSwwQkFBT0gsTUFBTUssUUFBYixFQUF1QlIsRUFBdkIsQ0FBMEJLLEVBQTFCLENBQTZCSSxLQUE3QjtBQUNBLDBCQUFPTixNQUFNTyxTQUFiLEVBQXdCVixFQUF4QixDQUEyQkMsSUFBM0IsQ0FBZ0NDLE1BQWhDLENBQXVDLENBQXZDO0FBQ0EsMEJBQU9DLE1BQU1PLFNBQU4sQ0FBZ0IsQ0FBaEIsRUFBbUJDLElBQTFCLEVBQWdDWCxFQUFoQyxDQUFtQ0ssRUFBbkMsQ0FBc0NDLEtBQXRDLENBQTRDLFdBQTVDO0FBQ0EsMEJBQU9ILE1BQU1PLFNBQU4sQ0FBZ0IsQ0FBaEIsRUFBbUJDLElBQTFCLEVBQWdDWCxFQUFoQyxDQUFtQ0ssRUFBbkMsQ0FBc0NDLEtBQXRDLENBQTRDLFdBQTVDO0FBQ0EsMEJBQU9ILE1BQU1TLFVBQWIsRUFBeUJaLEVBQXpCLENBQTRCQyxJQUE1QixDQUFpQ0MsTUFBakMsQ0FBd0MsQ0FBeEM7QUFDQSwwQkFBT0MsTUFBTVMsVUFBTixDQUFpQixDQUFqQixFQUFvQkMsVUFBcEIsQ0FBK0JGLElBQXRDLEVBQTRDWCxFQUE1QyxDQUErQ0ssRUFBL0MsQ0FBa0RDLEtBQWxELENBQXdELFdBQXhEOztBQUVBSCxnQkFBUU4sYUFBYUUsTUFBYixDQUFvQixDQUFwQixDQUFSO0FBQ0EsMEJBQU9JLE1BQU1DLElBQWIsRUFBbUJKLEVBQW5CLENBQXNCSyxFQUF0QixDQUF5QkMsS0FBekIsQ0FBK0IsT0FBL0I7QUFDQSwwQkFBT0gsTUFBTUksS0FBTixDQUFZSCxJQUFuQixFQUF5QkosRUFBekIsQ0FBNEJLLEVBQTVCLENBQStCQyxLQUEvQixDQUFxQyxpQkFBckM7QUFDQSwwQkFBT0gsTUFBTUssUUFBYixFQUF1QlIsRUFBdkIsQ0FBMEJLLEVBQTFCLENBQTZCUyxJQUE3QjtBQUNBLDBCQUFPWCxNQUFNTyxTQUFiLEVBQXdCVixFQUF4QixDQUEyQkMsSUFBM0IsQ0FBZ0NDLE1BQWhDLENBQXVDLENBQXZDO0FBQ0EsMEJBQU9DLE1BQU1TLFVBQWIsRUFBeUJaLEVBQXpCLENBQTRCQyxJQUE1QixDQUFpQ0MsTUFBakMsQ0FBd0MsQ0FBeEM7QUFDQSwwQkFBT0MsTUFBTVMsVUFBTixDQUFpQixDQUFqQixFQUFvQkMsVUFBcEIsQ0FBK0JGLElBQXRDLEVBQTRDWCxFQUE1QyxDQUErQ0ssRUFBL0MsQ0FBa0RDLEtBQWxELENBQXdELFdBQXhEO0FBQ0EsMEJBQU9ILE1BQU1TLFVBQU4sQ0FBaUIsQ0FBakIsRUFBb0JDLFVBQXBCLENBQStCRixJQUF0QyxFQUE0Q1gsRUFBNUMsQ0FBK0NLLEVBQS9DLENBQWtEQyxLQUFsRCxDQUF3RCxXQUF4RDtBQUNILEtBeENEOztBQTBDQVgsT0FBRyxnQkFBSCxFQUFxQixZQUFXO0FBQzVCLFlBQU1DLE1BQU0sd01BQVo7O0FBU0EsWUFBTUMsZUFBZSxlQUFRRCxHQUFSLEVBQWEsRUFBQ0UsYUFBYSxDQUFkLEVBQWIsQ0FBckI7QUFDQSwwQkFBT0QsYUFBYUUsTUFBcEIsRUFBNEJDLEVBQTVCLENBQStCQyxJQUEvQixDQUFvQ0MsTUFBcEMsQ0FBMkMsQ0FBM0M7O0FBRUEsWUFBTUMsUUFBUU4sYUFBYUUsTUFBYixDQUFvQixDQUFwQixDQUFkO0FBQ0EsMEJBQU9JLE1BQU1DLElBQWIsRUFBbUJKLEVBQW5CLENBQXNCSyxFQUF0QixDQUF5QkMsS0FBekIsQ0FBK0IsUUFBL0I7QUFDQSwwQkFBT0gsTUFBTUksS0FBTixDQUFZSCxJQUFuQixFQUF5QkosRUFBekIsQ0FBNEJLLEVBQTVCLENBQStCQyxLQUEvQixDQUFxQyxTQUFyQztBQUNBLDBCQUFPSCxNQUFNSyxRQUFiLEVBQXVCUixFQUF2QixDQUEwQkssRUFBMUIsQ0FBNkJJLEtBQTdCO0FBQ0EsMEJBQU9OLE1BQU1PLFNBQWIsRUFBd0JWLEVBQXhCLENBQTJCQyxJQUEzQixDQUFnQ0MsTUFBaEMsQ0FBdUMsQ0FBdkM7QUFDQSwwQkFBT0MsTUFBTU8sU0FBTixDQUFnQixDQUFoQixFQUFtQkMsSUFBMUIsRUFBZ0NYLEVBQWhDLENBQW1DSyxFQUFuQyxDQUFzQ0MsS0FBdEMsQ0FBNEMsTUFBNUM7QUFDQSwwQkFBT0gsTUFBTU8sU0FBTixDQUFnQixDQUFoQixFQUFtQkMsSUFBMUIsRUFBZ0NYLEVBQWhDLENBQW1DSyxFQUFuQyxDQUFzQ0MsS0FBdEMsQ0FBNEMsTUFBNUM7QUFDQSwwQkFBT0gsTUFBTVMsVUFBYixFQUF5QlosRUFBekIsQ0FBNEJDLElBQTVCLENBQWlDQyxNQUFqQyxDQUF3QyxDQUF4QztBQUNBLDBCQUFPQyxNQUFNUyxVQUFOLENBQWlCLENBQWpCLEVBQW9CQyxVQUFwQixDQUErQkYsSUFBdEMsRUFBNENYLEVBQTVDLENBQStDSyxFQUEvQyxDQUFrREMsS0FBbEQsQ0FBd0QsTUFBeEQ7QUFDQSwwQkFBT0gsTUFBTVMsVUFBTixDQUFpQixDQUFqQixFQUFvQkMsVUFBcEIsQ0FBK0JGLElBQXRDLEVBQTRDWCxFQUE1QyxDQUErQ0ssRUFBL0MsQ0FBa0RDLEtBQWxELENBQXdELE1BQXhEO0FBQ0gsS0F2QkQ7QUF3QkgsQ0F0S0Q7O0FBd0tBO0FBbk1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImVzNi1jbGFzcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIC0qLSBjb2Rpbmc6IHV0Zi04IC0qLVxuLy8gIENvcHlyaWdodCAoQykgMjAxNCBZdXN1a2UgU3V6dWtpIDx1dGF0YW5lLnRlYUBnbWFpbC5jb20+XG4vL1xuLy8gIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dFxuLy8gIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuLy9cbi8vICAgICogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHRcbi8vICAgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLlxuLy8gICAgKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodFxuLy8gICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlXG4vLyAgICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uXG4vL1xuLy8gIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMgXCJBUyBJU1wiXG4vLyAgQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRVxuLy8gIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFXG4vLyAgQVJFIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIDxDT1BZUklHSFQgSE9MREVSPiBCRSBMSUFCTEUgRk9SIEFOWVxuLy8gIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTXG4vLyAgKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTO1xuLy8gIExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORFxuLy8gIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUXG4vLyAgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GXG4vLyAgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cblxuaW1wb3J0IHsgZXhwZWN0IH0gZnJvbSAnY2hhaSc7XG5pbXBvcnQgeyBwYXJzZSB9IGZyb20gJy4uL3RoaXJkX3BhcnR5L2VzcHJpbWEnO1xuaW1wb3J0IHsgYW5hbHl6ZSB9IGZyb20gJy4uJztcblxuZGVzY3JpYmUoJ0VTNiBjbGFzcycsIGZ1bmN0aW9uKCkge1xuICAgIGl0KCdkZWNsYXJhdGlvbiBuYW1lIGNyZWF0ZXMgY2xhc3Mgc2NvcGUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc3QgYXN0ID0gcGFyc2UoYFxuICAgICAgICAgICAgY2xhc3MgRGVyaXZlZCBleHRlbmRzIEJhc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ldyBEZXJpdmVkKCk7XG4gICAgICAgIGApO1xuXG4gICAgICAgIGNvbnN0IHNjb3BlTWFuYWdlciA9IGFuYWx5emUoYXN0LCB7ZWNtYVZlcnNpb246IDZ9KTtcbiAgICAgICAgZXhwZWN0KHNjb3BlTWFuYWdlci5zY29wZXMpLnRvLmhhdmUubGVuZ3RoKDMpO1xuXG4gICAgICAgIGxldCBzY29wZSA9IHNjb3BlTWFuYWdlci5zY29wZXNbMF07XG4gICAgICAgIGV4cGVjdChzY29wZS50eXBlKS50by5iZS5lcXVhbCgnZ2xvYmFsJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5ibG9jay50eXBlKS50by5iZS5lcXVhbCgnUHJvZ3JhbScpO1xuICAgICAgICBleHBlY3Qoc2NvcGUuaXNTdHJpY3QpLnRvLmJlLmZhbHNlO1xuICAgICAgICBleHBlY3Qoc2NvcGUudmFyaWFibGVzKS50by5oYXZlLmxlbmd0aCgxKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnZhcmlhYmxlc1swXS5uYW1lKS50by5iZS5lcXVhbCgnRGVyaXZlZCcpO1xuICAgICAgICBleHBlY3Qoc2NvcGUucmVmZXJlbmNlcykudG8uaGF2ZS5sZW5ndGgoMik7XG4gICAgICAgIGV4cGVjdChzY29wZS5yZWZlcmVuY2VzWzBdLmlkZW50aWZpZXIubmFtZSkudG8uYmUuZXF1YWwoJ0Jhc2UnKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnJlZmVyZW5jZXNbMV0uaWRlbnRpZmllci5uYW1lKS50by5iZS5lcXVhbCgnRGVyaXZlZCcpO1xuXG4gICAgICAgIHNjb3BlID0gc2NvcGVNYW5hZ2VyLnNjb3Blc1sxXTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnR5cGUpLnRvLmJlLmVxdWFsKCdjbGFzcycpO1xuICAgICAgICBleHBlY3Qoc2NvcGUuYmxvY2sudHlwZSkudG8uYmUuZXF1YWwoJ0NsYXNzRGVjbGFyYXRpb24nKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLmlzU3RyaWN0KS50by5iZS50cnVlO1xuICAgICAgICBleHBlY3Qoc2NvcGUudmFyaWFibGVzKS50by5oYXZlLmxlbmd0aCgxKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnZhcmlhYmxlc1swXS5uYW1lKS50by5iZS5lcXVhbCgnRGVyaXZlZCcpO1xuICAgICAgICBleHBlY3Qoc2NvcGUucmVmZXJlbmNlcykudG8uaGF2ZS5sZW5ndGgoMCk7XG5cbiAgICAgICAgc2NvcGUgPSBzY29wZU1hbmFnZXIuc2NvcGVzWzJdO1xuICAgICAgICBleHBlY3Qoc2NvcGUudHlwZSkudG8uYmUuZXF1YWwoJ2Z1bmN0aW9uJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5ibG9jay50eXBlKS50by5iZS5lcXVhbCgnRnVuY3Rpb25FeHByZXNzaW9uJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5pc1N0cmljdCkudG8uYmUudHJ1ZTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnZhcmlhYmxlcykudG8uaGF2ZS5sZW5ndGgoMSk7XG4gICAgICAgIGV4cGVjdChzY29wZS52YXJpYWJsZXNbMF0ubmFtZSkudG8uYmUuZXF1YWwoJ2FyZ3VtZW50cycpO1xuICAgICAgICBleHBlY3Qoc2NvcGUucmVmZXJlbmNlcykudG8uaGF2ZS5sZW5ndGgoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZXhwcmVzc2lvbiBuYW1lIGNyZWF0ZXMgY2xhc3Mgc2NvcGUjMScsIGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zdCBhc3QgPSBwYXJzZShgXG4gICAgICAgICAgICAoY2xhc3MgRGVyaXZlZCBleHRlbmRzIEJhc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICBgKTtcblxuICAgICAgICBjb25zdCBzY29wZU1hbmFnZXIgPSBhbmFseXplKGFzdCwge2VjbWFWZXJzaW9uOiA2fSk7XG4gICAgICAgIGV4cGVjdChzY29wZU1hbmFnZXIuc2NvcGVzKS50by5oYXZlLmxlbmd0aCgzKTtcblxuICAgICAgICBsZXQgc2NvcGUgPSBzY29wZU1hbmFnZXIuc2NvcGVzWzBdO1xuICAgICAgICBleHBlY3Qoc2NvcGUudHlwZSkudG8uYmUuZXF1YWwoJ2dsb2JhbCcpO1xuICAgICAgICBleHBlY3Qoc2NvcGUuYmxvY2sudHlwZSkudG8uYmUuZXF1YWwoJ1Byb2dyYW0nKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLmlzU3RyaWN0KS50by5iZS5mYWxzZTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnZhcmlhYmxlcykudG8uaGF2ZS5sZW5ndGgoMCk7XG4gICAgICAgIGV4cGVjdChzY29wZS5yZWZlcmVuY2VzKS50by5oYXZlLmxlbmd0aCgxKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnJlZmVyZW5jZXNbMF0uaWRlbnRpZmllci5uYW1lKS50by5iZS5lcXVhbCgnQmFzZScpO1xuXG4gICAgICAgIHNjb3BlID0gc2NvcGVNYW5hZ2VyLnNjb3Blc1sxXTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnR5cGUpLnRvLmJlLmVxdWFsKCdjbGFzcycpO1xuICAgICAgICBleHBlY3Qoc2NvcGUuYmxvY2sudHlwZSkudG8uYmUuZXF1YWwoJ0NsYXNzRXhwcmVzc2lvbicpO1xuICAgICAgICBleHBlY3Qoc2NvcGUuaXNTdHJpY3QpLnRvLmJlLnRydWU7XG4gICAgICAgIGV4cGVjdChzY29wZS52YXJpYWJsZXMpLnRvLmhhdmUubGVuZ3RoKDEpO1xuICAgICAgICBleHBlY3Qoc2NvcGUudmFyaWFibGVzWzBdLm5hbWUpLnRvLmJlLmVxdWFsKCdEZXJpdmVkJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5yZWZlcmVuY2VzKS50by5oYXZlLmxlbmd0aCgwKTtcblxuICAgICAgICBzY29wZSA9IHNjb3BlTWFuYWdlci5zY29wZXNbMl07XG4gICAgICAgIGV4cGVjdChzY29wZS50eXBlKS50by5iZS5lcXVhbCgnZnVuY3Rpb24nKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLmJsb2NrLnR5cGUpLnRvLmJlLmVxdWFsKCdGdW5jdGlvbkV4cHJlc3Npb24nKTtcbiAgICB9KTtcblxuICAgIGl0KCdleHByZXNzaW9uIG5hbWUgY3JlYXRlcyBjbGFzcyBzY29wZSMyJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnN0IGFzdCA9IHBhcnNlKGBcbiAgICAgICAgICAgIChjbGFzcyBleHRlbmRzIEJhc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICBgKTtcblxuICAgICAgICBjb25zdCBzY29wZU1hbmFnZXIgPSBhbmFseXplKGFzdCwge2VjbWFWZXJzaW9uOiA2fSk7XG4gICAgICAgIGV4cGVjdChzY29wZU1hbmFnZXIuc2NvcGVzKS50by5oYXZlLmxlbmd0aCgzKTtcblxuICAgICAgICBsZXQgc2NvcGUgPSBzY29wZU1hbmFnZXIuc2NvcGVzWzBdO1xuICAgICAgICBleHBlY3Qoc2NvcGUudHlwZSkudG8uYmUuZXF1YWwoJ2dsb2JhbCcpO1xuICAgICAgICBleHBlY3Qoc2NvcGUuYmxvY2sudHlwZSkudG8uYmUuZXF1YWwoJ1Byb2dyYW0nKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLmlzU3RyaWN0KS50by5iZS5mYWxzZTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnZhcmlhYmxlcykudG8uaGF2ZS5sZW5ndGgoMCk7XG4gICAgICAgIGV4cGVjdChzY29wZS5yZWZlcmVuY2VzKS50by5oYXZlLmxlbmd0aCgxKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnJlZmVyZW5jZXNbMF0uaWRlbnRpZmllci5uYW1lKS50by5iZS5lcXVhbCgnQmFzZScpO1xuXG4gICAgICAgIHNjb3BlID0gc2NvcGVNYW5hZ2VyLnNjb3Blc1sxXTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnR5cGUpLnRvLmJlLmVxdWFsKCdjbGFzcycpO1xuICAgICAgICBleHBlY3Qoc2NvcGUuYmxvY2sudHlwZSkudG8uYmUuZXF1YWwoJ0NsYXNzRXhwcmVzc2lvbicpO1xuXG4gICAgICAgIHNjb3BlID0gc2NvcGVNYW5hZ2VyLnNjb3Blc1syXTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnR5cGUpLnRvLmJlLmVxdWFsKCdmdW5jdGlvbicpO1xuICAgICAgICBleHBlY3Qoc2NvcGUuYmxvY2sudHlwZSkudG8uYmUuZXF1YWwoJ0Z1bmN0aW9uRXhwcmVzc2lvbicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2NvbXB1dGVkIHByb3BlcnR5IGtleSBtYXkgcmVmZXIgdmFyaWFibGVzJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnN0IGFzdCA9IHBhcnNlKGBcbiAgICAgICAgICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHl1eXVzaGlraSA9IDQyO1xuICAgICAgICAgICAgICAgIChjbGFzcyB7XG4gICAgICAgICAgICAgICAgICAgIFt5dXl1c2hpa2ldKCkge1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgW3l1eXVzaGlraSArIDQwXSgpIHtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSgpKTtcbiAgICAgICAgYCk7XG5cbiAgICAgICAgY29uc3Qgc2NvcGVNYW5hZ2VyID0gYW5hbHl6ZShhc3QsIHtlY21hVmVyc2lvbjogNn0pO1xuICAgICAgICBleHBlY3Qoc2NvcGVNYW5hZ2VyLnNjb3BlcykudG8uaGF2ZS5sZW5ndGgoNSk7XG5cbiAgICAgICAgbGV0IHNjb3BlID0gc2NvcGVNYW5hZ2VyLnNjb3Blc1swXTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnR5cGUpLnRvLmJlLmVxdWFsKCdnbG9iYWwnKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLmJsb2NrLnR5cGUpLnRvLmJlLmVxdWFsKCdQcm9ncmFtJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5pc1N0cmljdCkudG8uYmUuZmFsc2U7XG5cbiAgICAgICAgc2NvcGUgPSBzY29wZU1hbmFnZXIuc2NvcGVzWzFdO1xuICAgICAgICBleHBlY3Qoc2NvcGUudHlwZSkudG8uYmUuZXF1YWwoJ2Z1bmN0aW9uJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5ibG9jay50eXBlKS50by5iZS5lcXVhbCgnRnVuY3Rpb25FeHByZXNzaW9uJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5pc1N0cmljdCkudG8uYmUuZmFsc2U7XG4gICAgICAgIGV4cGVjdChzY29wZS52YXJpYWJsZXMpLnRvLmhhdmUubGVuZ3RoKDIpO1xuICAgICAgICBleHBlY3Qoc2NvcGUudmFyaWFibGVzWzBdLm5hbWUpLnRvLmJlLmVxdWFsKCdhcmd1bWVudHMnKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnZhcmlhYmxlc1sxXS5uYW1lKS50by5iZS5lcXVhbCgneXV5dXNoaWtpJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5yZWZlcmVuY2VzKS50by5oYXZlLmxlbmd0aCgxKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnJlZmVyZW5jZXNbMF0uaWRlbnRpZmllci5uYW1lKS50by5iZS5lcXVhbCgneXV5dXNoaWtpJyk7XG5cbiAgICAgICAgc2NvcGUgPSBzY29wZU1hbmFnZXIuc2NvcGVzWzJdO1xuICAgICAgICBleHBlY3Qoc2NvcGUudHlwZSkudG8uYmUuZXF1YWwoJ2NsYXNzJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5ibG9jay50eXBlKS50by5iZS5lcXVhbCgnQ2xhc3NFeHByZXNzaW9uJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5pc1N0cmljdCkudG8uYmUudHJ1ZTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnZhcmlhYmxlcykudG8uaGF2ZS5sZW5ndGgoMCk7XG4gICAgICAgIGV4cGVjdChzY29wZS5yZWZlcmVuY2VzKS50by5oYXZlLmxlbmd0aCgyKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnJlZmVyZW5jZXNbMF0uaWRlbnRpZmllci5uYW1lKS50by5iZS5lcXVhbCgneXV5dXNoaWtpJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5yZWZlcmVuY2VzWzFdLmlkZW50aWZpZXIubmFtZSkudG8uYmUuZXF1YWwoJ3l1eXVzaGlraScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3JlZ3Jlc3Npb24gIzQ5JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnN0IGFzdCA9IHBhcnNlKGBcbiAgICAgICAgICAgIGNsYXNzIFNob2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgICAgICAgICAvL1Nob2UueCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHNob2UgPSBuZXcgU2hvZSgpO1xuICAgICAgICBgKTtcblxuICAgICAgICBjb25zdCBzY29wZU1hbmFnZXIgPSBhbmFseXplKGFzdCwge2VjbWFWZXJzaW9uOiA2fSk7XG4gICAgICAgIGV4cGVjdChzY29wZU1hbmFnZXIuc2NvcGVzKS50by5oYXZlLmxlbmd0aCgzKTtcblxuICAgICAgICBjb25zdCBzY29wZSA9IHNjb3BlTWFuYWdlci5zY29wZXNbMF07XG4gICAgICAgIGV4cGVjdChzY29wZS50eXBlKS50by5iZS5lcXVhbCgnZ2xvYmFsJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5ibG9jay50eXBlKS50by5iZS5lcXVhbCgnUHJvZ3JhbScpO1xuICAgICAgICBleHBlY3Qoc2NvcGUuaXNTdHJpY3QpLnRvLmJlLmZhbHNlO1xuICAgICAgICBleHBlY3Qoc2NvcGUudmFyaWFibGVzKS50by5oYXZlLmxlbmd0aCgyKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnZhcmlhYmxlc1swXS5uYW1lKS50by5iZS5lcXVhbCgnU2hvZScpO1xuICAgICAgICBleHBlY3Qoc2NvcGUudmFyaWFibGVzWzFdLm5hbWUpLnRvLmJlLmVxdWFsKCdzaG9lJyk7XG4gICAgICAgIGV4cGVjdChzY29wZS5yZWZlcmVuY2VzKS50by5oYXZlLmxlbmd0aCgyKTtcbiAgICAgICAgZXhwZWN0KHNjb3BlLnJlZmVyZW5jZXNbMF0uaWRlbnRpZmllci5uYW1lKS50by5iZS5lcXVhbCgnc2hvZScpO1xuICAgICAgICBleHBlY3Qoc2NvcGUucmVmZXJlbmNlc1sxXS5pZGVudGlmaWVyLm5hbWUpLnRvLmJlLmVxdWFsKCdTaG9lJyk7XG4gICAgfSk7XG59KTtcblxuLy8gdmltOiBzZXQgc3c9NCB0cz00IGV0IHR3PTgwIDpcbiJdfQ==
